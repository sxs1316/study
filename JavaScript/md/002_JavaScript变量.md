## 声明变量

在JavaScript中声明变量使用`var`语句

```javascript
//声明一个变量
var a;
//声明多个变量
var b, c;
//在声明变量时赋值，未赋值的变量初始值为undefined
var d = 1;
```

JavaScript允许用户不声明变量，而直接为变量赋值，这是因为JavaScript解释器能够自动隐式声明变量。但是隐式声明的变量总是作为全局变量而存在的。
但是，如果尝试读取一个未声明的变量的值，JavaScript 会提示语法错误。为变量赋值的过程，实际上JavaScript
也会隐式进行声明。在使用变量时，用户应养成良好习惯:先声明，后读写;先赋值,后运算。
var语句声明的变量是JavaScript标准声明变量的方法，同时使用var语句声明的变量是永久性的，不能够使用delete运算符删除该变量。

## 赋值变量

使用等号(=）运算符可以为变量赋值，等号左侧为变量，右侧为具体的值。
JavaScript 在预编译期会先预处理声明的变量。但是，变量的赋值操作发生在JavaScript执行期，而不是预编译期。

> JavaScript在预编译期会先预处理声明的变量。但是，变量的赋值操作发生在JavaScript执行期,而不是预编译期。

```javascript
function f() {
    a = 1;              // 全局变量a赋值为1
    var b = 2;          // 局部变量b赋值为2
}

try {
    alert(a);           // 尝试读取全局变量a
} catch (e) {
    alert(e.message);   // 显示错误信息：变量a未定义
}
f();                    // 调用函数
alert(a);               // 读取全局变量a，返回1
```

函数未调用之前，函数内部定义的全局变量是无效的，这是因为在JavaScript预编译期，仅对函数名、函数内各种标识符建立索引。
只有当在JavaScript执行期时，才按顺序为变量进行赋值，并初始化。而在执行期，如果函数未被调用，则函数内代码是不被解析的。

> JavaScript解析过程

```javascript
var a = 1;              // 声明并初始化局部变量
(function f() {
    alert(a);           // 返回 undefined
    var a = 2;          // 声明并初始化局部变量
    alert(a);           // 返回2
})()
```

上面代码显示，由于在函数内部声明了一个同名局部变量a，所以在预编译期，JavaScript使用该变量覆盖掉全局变量对于函数内部的影响。而在执行初期，局部变量a未赋值，所以在函数第Ⅰ行代码中读取局部变量a的值也就是undefined了。当执行到函数第⒉行代码时，则为局部变量赋值2.

## 变量的作用域

变量的作用域（scope）是指变量在程序中可访问的有效范围，也称为变量的可见性。在JavaScript中，变量作用域可以分为全局作用域和局部作用域。

- 全局作用域是指变量在整个页面脚本中都是可见的，可以自由访问。
- 局部作用域是指变量仅能在声明的函数内部可见，函数外是不允许访问的。
  在函数体内使用全局变量是一种很危险的行为，很可能函数就会改变程序中其他部分的使用值。为了避免此类问题的发生，应该养成在函数体内使用var语句声明局部变量的习惯。

## 避免变量污染

定义全局变量的三种方式

- 在任何函数外直接执行`var`语句
- 直接添加一个属性到全局对象上。全局对象是所有全局变量的容器。在Web浏览器中，全局对象名为 window。
- 直接使用未经声明的变量，以这种方式定义的全局变量被称为隐式的全局变量。

JavaScript最为糟糕的就是对全局变量的依赖。由于在所有作用域中都可见，使用全局变量会降低程序的可靠性。

> 避免使用全局变量，努力减少使用全局变量的方法:在应用程序中创建唯一一个全局变量，并定义该变量为当前应用的容器。

```javascript
var My = {};
My.name = {
    "first-name": "first",
    "last-name": 'last'
};
My.work = {
    one: {
        name: 'one',
        time: '2022'
    }
};
```

只要把多个全局变量都追加在一个名称空间下，就可以降低与其他应用程序产生冲突的几率，应用程序也会变得更容易阅读。

> 使用函数体将信息隐藏起来

```javascript
var foo = function () {
    var a = 1, b = 2;
    var bat = function () {
        var b = 3, c = 4;
        a += b + c;
    };
    bar();
};
```

JavaScript支持函数作用域，定义在函数中的参数和变量在函数外部是不可见的，且在一个函数中的任何位置定义的变量在该函数中的任何地方都可见。